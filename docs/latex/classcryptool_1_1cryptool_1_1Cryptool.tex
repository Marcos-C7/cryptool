\hypertarget{classcryptool_1_1cryptool_1_1Cryptool}{}\doxysection{cryptool.\+cryptool.\+Cryptool Class Reference}
\label{classcryptool_1_1cryptool_1_1Cryptool}\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a85ecad72cf9c2b7c28b36284175e6077}\label{classcryptool_1_1cryptool_1_1Cryptool_a85ecad72cf9c2b7c28b36284175e6077}} 
def {\bfseries \+\_\+\+\_\+init\+\_\+\+\_\+} (self)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_ad03e7899f6db97430ad0d588a236220a}{get\+K\+DF}} (self, salt, length=None)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_a42f1d1075038ee69f87bfe6612f4ee16}{get\+Cipher\+Algorithm}} (self, key)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_abfd4ff322a73d7e042b636a248a0ea2b}{msg\+To\+Bytes}} (self, msg, enc=None)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_a66c21313abb4ec811fb48f29d8e663b0}{get\+Hash}} (self, msg)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_af9b3d69462542951043941e990c202e2}{get\+Credentials\+From\+Password}} (self, password, length=None, salt=None)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_a850afc25f0da73096fd5533d2a724d12}{encrypt\+Msg}} (self, msg, password, source=\char`\"{}bytes\char`\"{})
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_a6df9cada3e56000a3182bf7528376e37}{decrypt\+Msg}} (self, enc\+\_\+card, password)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_ae353f3ae6122911de6617c316b23d144}{encrypt\+File}} (self, password, input\+\_\+path, output\+\_\+name=None, source=\char`\"{}file\char`\"{})
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_a59081f5bc5068fe3b03d011f0d48a365}{encrypt\+Dir}} (self, password, input\+\_\+path, output\+\_\+name=None)
\item 
def \mbox{\hyperlink{classcryptool_1_1cryptool_1_1Cryptool_ad73e57d2cbec34e1670dbf8ebea33464}{decrypt\+File}} (self, password, input\+\_\+path, output\+\_\+path=None)
\end{DoxyCompactItemize}
\doxysubsection*{Public Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a9952d4cef81726d500269da30b19d67c}\label{classcryptool_1_1cryptool_1_1Cryptool_a9952d4cef81726d500269da30b19d67c}} 
{\bfseries encoding}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a5fae145a8f2b4908e2a11d8de0a20d0c}\label{classcryptool_1_1cryptool_1_1Cryptool_a5fae145a8f2b4908e2a11d8de0a20d0c}} 
{\bfseries hash\+\_\+algorithm}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_aa1a2466c1e7a7bf810f224b27d472f53}\label{classcryptool_1_1cryptool_1_1Cryptool_aa1a2466c1e7a7bf810f224b27d472f53}} 
{\bfseries key\+\_\+length}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a2f7ba4ef00287ed8659327991f7b7555}\label{classcryptool_1_1cryptool_1_1Cryptool_a2f7ba4ef00287ed8659327991f7b7555}} 
{\bfseries kdf\+\_\+iterations}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a63ddbae806dbdd2d21904bb6b2832f52}\label{classcryptool_1_1cryptool_1_1Cryptool_a63ddbae806dbdd2d21904bb6b2832f52}} 
{\bfseries salt}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a4d8f0baffcf24d022753e483e796b83f}\label{classcryptool_1_1cryptool_1_1Cryptool_a4d8f0baffcf24d022753e483e796b83f}} 
{\bfseries extension}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a5459bc07c7bfcf0e9ba79b40d6f971b8}\label{classcryptool_1_1cryptool_1_1Cryptool_a5459bc07c7bfcf0e9ba79b40d6f971b8}} 
{\bfseries sources}
\item 
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_af03ea4a4c6945a8f2ce5f92f97918a8c}\label{classcryptool_1_1cryptool_1_1Cryptool_af03ea4a4c6945a8f2ce5f92f97918a8c}} 
{\bfseries sources\+\_\+r}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Class to simplify the encryption and decryption of data presented either in text strings, raw bytes or files.
\end{DoxyVerb}
 

\doxysubsection{Member Function Documentation}
\mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_ad73e57d2cbec34e1670dbf8ebea33464}\label{classcryptool_1_1cryptool_1_1Cryptool_ad73e57d2cbec34e1670dbf8ebea33464}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!decryptFile@{decryptFile}}
\index{decryptFile@{decryptFile}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{decryptFile()}{decryptFile()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+decrypt\+File (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password,  }\item[{}]{input\+\_\+path,  }\item[{}]{output\+\_\+path = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Decripts the file given in 'input_path' and saves the resulting decrypted data
to the file with path name given in 'output_path'. If the encrypted data corresponds
to a directory, then its content will be placed in the directory 'output_path'.
If no output path is given, then it is necessary that the input file has extension
'self.extension' in order to take the input path as the output path without such 
extension.
Parameters:
- password [bytes/str]: the password used for the decryption.
- input_path [str]: the absolute/relative path to the target file.
- output_path [str]: the path of the output file.
Return:
[dict]: relevant data about the procedure, in the form of a dictionray with the entries:
- "status" [str]: "OK" if everyhing went well, otherwise an error message.
Usage:
- res = self.decryptFile(password, "input/file", "output/file")
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a6df9cada3e56000a3182bf7528376e37}\label{classcryptool_1_1cryptool_1_1Cryptool_a6df9cada3e56000a3182bf7528376e37}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!decryptMsg@{decryptMsg}}
\index{decryptMsg@{decryptMsg}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{decryptMsg()}{decryptMsg()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+decrypt\+Msg (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{enc\+\_\+card,  }\item[{}]{password }\end{DoxyParamCaption})}

\begin{DoxyVerb}Attempts to decrypt the data given in the encryption card, with the given password.
If the encryted data is corrupted or the password is wrong, then an "invalid or 
corrupted data" error will be returned. An encryption card is generated with the 
'self.encryptMsg' method. Message authentication will be verified. The result will 
be given in the form of a decryption card containing relevant information about the 
decryption procedure and the result.
Parameters:
- enc_card [dict]: the card with the encrypted data, must have at least the entry
  "signed_data" mapping to the raw bytes string to decrypt.
- password [bytes/str]: the password to use in the decryption.
Return:
[dict]: The decryption card in the form of a dictionary, with the following entries:
- "status" [str]: "OK" if everyhing went well, otherwise an error message.
- "msg" [bytes]: the dectypted message.
- "source" [str]: the 'source' where the data comes from, one of "bytes", "str", 
  "file" or "dir". See the documentation of 'self.encryptMsg' for more information.
- "enc_time" [struct_time]: the time when the message was encrypted.
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a59081f5bc5068fe3b03d011f0d48a365}\label{classcryptool_1_1cryptool_1_1Cryptool_a59081f5bc5068fe3b03d011f0d48a365}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!encryptDir@{encryptDir}}
\index{encryptDir@{encryptDir}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{encryptDir()}{encryptDir()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+encrypt\+Dir (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password,  }\item[{}]{input\+\_\+path,  }\item[{}]{output\+\_\+name = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encripts the directory (with all its content) given in 'input_path' and saves 
the resulting encrypted data to the file with path name given in 'output_name'
but appending the extension 'self.extension'.
Parameters:
- password [bytes/str]: the password used for the encryption.
- input_path [str]: the absolute/relative path to the target directory.
- output_name [str]: the extension 'self.extension' will be appended to this path name.
  The default output name is equal to 'input_path'.
Return:
[dict]: relevant data about the procedure, in the form of a dictionray with the entries:
- "status" [str]: "OK" if everyhing went well, otherwise an error message.
Usage:
- res = self.encryptFile(password, "input/file", "output/name")
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_ae353f3ae6122911de6617c316b23d144}\label{classcryptool_1_1cryptool_1_1Cryptool_ae353f3ae6122911de6617c316b23d144}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!encryptFile@{encryptFile}}
\index{encryptFile@{encryptFile}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{encryptFile()}{encryptFile()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+encrypt\+File (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password,  }\item[{}]{input\+\_\+path,  }\item[{}]{output\+\_\+name = {\ttfamily None},  }\item[{}]{source = {\ttfamily \char`\"{}file\char`\"{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encripts the file given in 'input_path' and saves the resulting encrypted data
to the file with path name given in 'output_name' but appending the extension
'self.extension'. Is not output name is given then 'input_path' will be used.
We can change the tag of the 'source' of the data, in case we want to use files
as intermediate steps during encryption of other type of sources.
Parameters:
- password [bytes/str]: the password used for the encryption.
- input_path [str]: the absolute/relative path to the target file.
- output_name [str]: the extension 'self.extension' will be appended to this path name.
  The default output name is equal to 'input_path'.
- source [str]: "bytes", "str", "file" or "dir". The default is "file". See the 
  documentation of 'self.encryptMsg' for more information.
Return:
[dict]: relevant data about the procedure, in the form of a dictionray with the entries:
- "status" [str]: "OK" if everyhing went well, otherwise an error message.
Usage:
- res = self.encryptFile(password, "input/file", "output/name")
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a850afc25f0da73096fd5533d2a724d12}\label{classcryptool_1_1cryptool_1_1Cryptool_a850afc25f0da73096fd5533d2a724d12}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!encryptMsg@{encryptMsg}}
\index{encryptMsg@{encryptMsg}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{encryptMsg()}{encryptMsg()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+encrypt\+Msg (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{msg,  }\item[{}]{password,  }\item[{}]{source = {\ttfamily \char`\"{}bytes\char`\"{}} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Encrypts the given message using the given password. The encrypted data is autenticated via a MAC
signature. We can tell the 'source' where the data comes from, so that we can determine 
when we decrypt data if a special post-processing is needed. The diferent sources are:
"bytes":raw bytes string | "str":text string | "file":a file | "dir":a directory
The result will be given in the form of an encryption card containing relevant information about 
the encryption procedure and the result.
Prameters:
- msg [bytes/str]: the message to encrypt.
- password [bytes/str]: the password used for the encryption.
- source [str]: "bytes", "str", "file" or "dir". The default is "bytes".
Return:
[dict]: The encryption card in the form of a dictionary, with the following entries:
- "status" [str]: "OK" if everyhing went well, otherwise an error message.
- "signed_data" [bytes]: the encrypted message.
Usage:
- enc_card = self.encryptMsg(msg, password)
  if enc_card["status"] == "OK": ... do something with enc_card["signed_data"] ...
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a42f1d1075038ee69f87bfe6612f4ee16}\label{classcryptool_1_1cryptool_1_1Cryptool_a42f1d1075038ee69f87bfe6612f4ee16}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!getCipherAlgorithm@{getCipherAlgorithm}}
\index{getCipherAlgorithm@{getCipherAlgorithm}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{getCipherAlgorithm()}{getCipherAlgorithm()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+get\+Cipher\+Algorithm (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{key }\end{DoxyParamCaption})}

\begin{DoxyVerb}Defines a cipher algorithm used in a Cipher Object to encrypt data using the given key.
This function is used in all the functions that use an encryption algorithm.
Parameters:
- key [bytes]: raw bytes string of size 'self.key_length' bytes used to encrypt the data.
Return:
- The encryption algorithm.
Usage:
- alg = self.getCipherAlgorithm(key)
  cipher = Cipher(alg, mode, backend=default_backend()).encryptor()
  decipher = Cipher(alg, mode, backend=default_backend()).decryptor()
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_af9b3d69462542951043941e990c202e2}\label{classcryptool_1_1cryptool_1_1Cryptool_af9b3d69462542951043941e990c202e2}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!getCredentialsFromPassword@{getCredentialsFromPassword}}
\index{getCredentialsFromPassword@{getCredentialsFromPassword}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{getCredentialsFromPassword()}{getCredentialsFromPassword()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+get\+Credentials\+From\+Password (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{password,  }\item[{}]{length = {\ttfamily None},  }\item[{}]{salt = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Creates a credentials card derived from the given 'password'. The credentials include a 
cryptograhic key of the given 'length' and the salt used to generate the key from the 
password. An optional 'salt' will can be provided to recover previously generated credentials.
Remember that in order to generate the same password we need the same pair password-salt.
Parameters:
- password [bytes/str]: the password to derive the key.
- length [int]: the lenght of the derived key, in bytes. The default is 'self.key_length'.
- salt [bytes]: the salt used to generate the key. If not give, a new one will be generated.
Return:
[dict]: the credentials in the form of a dictionary with entries:
- "key" [bytes]: the derived cryptographic key.
- "salt" [bytes]: the salt used in combination with the password to generatet the key.
Usage:
- cred = self.getCredentialsFromPassword(password)
  old_cred = self.getCredentialsFromPassword(password, cred["salt"])
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_a66c21313abb4ec811fb48f29d8e663b0}\label{classcryptool_1_1cryptool_1_1Cryptool_a66c21313abb4ec811fb48f29d8e663b0}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!getHash@{getHash}}
\index{getHash@{getHash}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{getHash()}{getHash()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+get\+Hash (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{msg }\end{DoxyParamCaption})}

\begin{DoxyVerb}Generate a secure hash (no key used) of the given message. The hash algorithm is defined
in 'self.hash_algorithm'. The resulting hash will have size 'self.hash_algorithm.digest_size'
in bytes.
Parameters:
msg [bytes/str]: message to hash.
Return:
[bytes]: the raw bytes hash.
Usage:
- hash = self.getHash(msg)
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_ad03e7899f6db97430ad0d588a236220a}\label{classcryptool_1_1cryptool_1_1Cryptool_ad03e7899f6db97430ad0d588a236220a}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!getKDF@{getKDF}}
\index{getKDF@{getKDF}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{getKDF()}{getKDF()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+get\+K\+DF (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{salt,  }\item[{}]{length = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Defines a Key Derivation Function (KDF). This is useful to generate secure cryptographic keys from
a simpler phrase like a password. The same pair password-salt always generates the same password of
the given length. This function is used in all the functions that use a KDF.
Parameters:
- salt [bytes]: raw bytes string of size 'self.key_length', use 'self.salt()' to obtain a secure salt.
- length [int]: the key generated with the returned KDF will have this size in Bytes.
Return:
- A key derivation function.
Usage:
 - kdf = self.getKDF(salt, length)
   key = kdf.derive(password)
\end{DoxyVerb}
 \mbox{\Hypertarget{classcryptool_1_1cryptool_1_1Cryptool_abfd4ff322a73d7e042b636a248a0ea2b}\label{classcryptool_1_1cryptool_1_1Cryptool_abfd4ff322a73d7e042b636a248a0ea2b}} 
\index{cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}!msgToBytes@{msgToBytes}}
\index{msgToBytes@{msgToBytes}!cryptool.cryptool.Cryptool@{cryptool.cryptool.Cryptool}}
\doxysubsubsection{\texorpdfstring{msgToBytes()}{msgToBytes()}}
{\footnotesize\ttfamily def cryptool.\+cryptool.\+Cryptool.\+msg\+To\+Bytes (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{msg,  }\item[{}]{enc = {\ttfamily None} }\end{DoxyParamCaption})}

\begin{DoxyVerb}The cryptographic methods work on raw bytes. In order to simplify the usage of
text strings, this function checks if the message is already in raw bytes and
if not, then it is assumed to be a text string and encodes to raw bytes.
Parameters:
- msg [byes/str]: the message to safely convert to raw bytes.
- enc [srt]: the encoding used to encode string objects, de default is 'self.encoding'.
Return:
- [bytes]: The raw bytes string.
Usage:
- msg = msgToBytes(msg)
- msg = msgToBytes(msg, "cp1252")
\end{DoxyVerb}
 

The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
cryptool.\+py\end{DoxyCompactItemize}
